<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link id="faviconLink" rel="icon" type="image/x-icon" href="../favicon-light.ico">
    <title>Admin Dashboard - Attendance Registration Application</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css">

    <script src="../theme-manager.js" defer></script>
    <script src="../common.js" defer></script>
    <script type="module" src="./main.js"></script>
</head>
<body class="light-mode">
    <div class="controls-left" role="region" aria-label="Left controls">
        <div class="control-item">
            <button id="logoutBtn" class="logout-btn" aria-label="Logout" title="Logout">
                <svg viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z" fill="#1e293b"/>
                </svg>
            </button>
        </div>
        
        <a href="http://localhost:8080/h2-console" target="_blank" class="db-btn" aria-label="Manage Database" title="Manage Database">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4zm8 5.5V11c0 2.21-3.58 4-8 4s-8-1.79-8-4V8.5C4 10.71 7.58 12.5 12 12.5S20 10.71 20 8.5zm0 5V16c0 2.21-3.58 4-8 4s-8-1.79-8-4v-2.5C4 15.71 7.58 17.5 12 17.5S20 15.71 20 13.5z" fill="#1e293b"/>
            </svg>
            <span>Manage Database</span>
        </a>
    </div>

    <div class="controls-container" role="region" aria-label="Controls">
        <div class="control-card">
            <span class="mode-label">Light Mode</span>
            <label class="switch" aria-hidden="true">
                <input type="checkbox" id="modeToggle">
                <span class="slider"></span>
            </label>
        </div>

        <div class="control-item">
            <button id="fullscreenBtn" class="fullscreen-btn" aria-label="Toggle fullscreen" title="Fullscreen">
                <svg id="fullscreenIcon" viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z" fill="#1e293b"/>
                </svg>
            </button>
        </div>
    </div>

    <div class="main-card">
        <h1 class="main-title">Device Management Dashboard</h1>
        <p class="main-label">Monitor and manage all connected devices</p>
        <div class="stats-row">
            <p class="main-label mb-0"><strong>Total Devices:</strong> <span id="totalDevices">5</span> | <strong>Online:</strong> <span id="onlineDevices">4</span> | <strong>Offline:</strong> <span id="offlineDevices">1</span></p>
            <button id="refreshBtn" class="refresh-btn" aria-label="Refresh devices" title="Refresh devices">
                <svg viewBox="0 0 24 24" fill="none" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" fill="#1e293b"/>
                </svg>
            </button>
        </div>

        <div class="devices-container">
            <div class="container-fluid">
                <div class="row g-4" id="deviceListContainer">
                    <!-- Device 1 -->
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="device-card">
                            <button class="edit-btn" onclick="editDevice(this)">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="currentColor"/>
                                </svg>
                            </button>
                            <div class="device-name">Scanner Unit A1</div>
                            <div class="device-info"><strong>ID:</strong> DEV-001</div>
                            <div class="device-info"><strong>Position:</strong> Main Entrance</div>
                            <div class="device-info"><strong>Type:</strong> QR Scanner</div>
                            <span class="status-badge status-online">● Online</span>
                        </div>
                    </div>

                    <!-- Device 2 -->
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="device-card">
                            <button class="edit-btn" onclick="editDevice(this)">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="currentColor"/>
                                </svg>
                            </button>
                            <div class="device-name">Scanner Unit B2</div>
                            <div class="device-info"><strong>ID:</strong> DEV-002</div>
                            <div class="device-info"><strong>Position:</strong> Building B - Floor 2</div>
                            <div class="device-info"><strong>Type:</strong> RFID Reader</div>
                            <span class="status-badge status-online">● Online</span>
                        </div>
                    </div>

                    <!-- Device 3 -->
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="device-card">
                            <button class="edit-btn" onclick="editDevice(this)">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="currentColor"/>
                                </svg>
                            </button>
                            <div class="device-name">Terminal C3</div>
                            <div class="device-info"><strong>ID:</strong> DEV-003</div>
                            <div class="device-info"><strong>Position:</strong> Reception Desk</div>
                            <div class="device-info"><strong>Type:</strong> Touch Terminal</div>
                            <span class="status-badge status-offline">● Offline</span>
                        </div>
                    </div>

                    <!-- Device 4 -->
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="device-card">
                            <button class="edit-btn" onclick="editDevice(this)">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="currentColor"/>
                                </svg>
                            </button>
                            <div class="device-name">Mobile Unit M1</div>
                            <div class="device-info"><strong>ID:</strong> DEV-004</div>
                            <div class="device-info"><strong>Position:</strong> Parking Lot</div>
                            <div class="device-info"><strong>Type:</strong> Mobile Scanner</div>
                            <span class="status-badge status-online">● Online</span>
                        </div>
                    </div>

                    <!-- Device 5 -->
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="device-card">
                            <button class="edit-btn" onclick="editDevice(this)">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="currentColor"/>
                                </svg>
                            </button>
                            <div class="device-name">Kiosk K1</div>
                            <div class="device-info"><strong>ID:</strong> DEV-005</div>
                            <div class="device-info"><strong>Position:</strong> Cafeteria</div>
                            <div class="device-info"><strong>Type:</strong> Self-Service Kiosk</div>
                            <span class="status-badge status-online">● Online</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <p class="site-credit" role="note">v1.0 • 2025 • Bug Busters</p>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal-card">
            <div class="modal-icon" id="modalIcon">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" fill="#dc2626"/>
                </svg>
            </div>
            <h2 class="modal-title" id="modalTitle">Confirm Action</h2>
            <p class="modal-message" id="modalMessage">Are you sure you want to proceed?</p>
            <div class="modal-actions">
                <button class="modal-btn cancel" id="modalCancel">Cancel</button>
                <button class="modal-btn confirm" id="modalConfirm">OK</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>

    <script>

        async function fetchReaderData()
        {
            // Readerek listájának olvasása, válasz JSON lesz
            try {
                // JSON objektum
                const data = {
                    context: "readers"
                };

                // Fetch POST kérés a szerver felé
                const response = await fetch('/admin', {
                    method: 'POST', // POST kérést küld
                    headers: {
                        'Content-Type': 'application/json' // JSON-ként kezeljük
                    },
                    body: JSON.stringify(data)
                });
                if (!response.ok) {
                    throw new Error("Hálózati hiba: " + response.status);
                }

                const result = await response.json();
                console.log("Szerver válasz:", result);
                // Itt kellene feldolgozni a választ és frissíteni a UI elemeket! ----------------------
            } catch (error) {
                console.error("Hiba történt a fetchelésnél:", error);
            }
        }

    </script>
</body>
</html>